# ⛰️ 또닥또닥 산악회 관리자 시스템 (Admin System)

본 시스템은 **또닥또닥 산악회**의 운영 효율화를 위해 설계된 전용 관리 도구입니다. DuckDB의 강력한 뷰(View) 기능을 활용하여 회원들의 활동 상태를 실시간으로 추적하고 포인트 및 시상 내역을 관리합니다.

## 🗄️ 데이터베이스 스키마 (Database Schema)

시스템은 `members`와 `events`를 주축으로 하며, `attendees`가 이 둘을 잇는 N:M 관계를 형성합니다.

### 1. `members` (회원 정보)
회원의 고유 신상 정보와 기준 포인트를 관리합니다.
- **주요 컬럼**: `user_no`(PK), `name`, `birth_year`, `area`, `point`(기본점수), `role`, `last_attended`(최신 참석일), `created_at` 등

### 2. `events` (산행/행사 일정)
과거 및 향후 진행될 모든 행사 정보를 담고 있습니다.
- **주요 컬럼**: `event_id`(PK), `title`, `date`, `score`(참석 점수), `host`(주최자, FK), `album_url`(네이버 밴드 사진첩), `url`(공지링크)

### 3. `attendees` (참석 기록)
행사별 참석자 명단을 기록하는 연결 테이블입니다.
- **복합키**: `(event_id, user_no)`를 통해 중복 참석 기록을 방지하며 각 테이블의 참조 무결성을 유지합니다.

---

## 📊 핵심 로직: 활동 요약 뷰 (`v_member_attendance_summary`)

본 앱의 가장 중요한 데이터 소스로, 실시간 계산을 통해 아래 정보들을 제공합니다.

### 1. 포인트 산정 방식
- **현재포인트**: 기존 기본 점수(`point`) + 2025년 10월 이후의 행사 참석 점수(`score`)의 총합.
- **획득점수**: 현재 월(Month)에 참여하여 얻은 당월 점수.

### 2. 회원 상태 분류 알고리즘 (Status)
시스템이 자동으로 회원의 활동성을 분석하여 4가지 상태로 분류합니다.

| 아이콘 | 상태명 | 판별 기준 (Logic) |
| :---: | :--- | :--- |
| **`🌱`** | 신입 | 누적 포인트가 0점인 초기 가입 상태 |
| **`🌱🚨`** | 신입 경고 | 가입 후 3개월간 참석 기록 및 획득 포인트가 없는 경우 |
| **`😴🚨`** | 장기 미참석 | 누적 점수는 있으나 마지막 참석일로부터 6개월 이상 경과한 경우 |
| **`😎`** | 활동중 | 위 경고 조건에 해당하지 않는 정상 활동 회원 |



---

## 🚀 주요 메뉴 및 기능

### 1. 👥 회원 관리
- **다중 필터링**: 생년(기수)별, 지역별 멀티 셀렉트 필터를 지원하여 특정 그룹을 빠르게 조회합니다.
- **스마트 업데이트**: `st.data_editor`를 사용하여 엑셀처럼 정보를 수정하며, **변경된 필드만** 골라내어 효율적으로 DB를 업데이트합니다.

### 2. 📅 일정 및 앨범 관리
- **년/월 필터링**: 수많은 산행 기록 중 원하는 시점의 데이터만 골라 볼 수 있습니다.
- **앨범 URL 연동**: 각 행사별 사진첩 링크를 저장하고, 보고서 생성 시 자동으로 불러와 공지 편의성을 높입니다.

### 3. 🏃 참가 기록 체크
- **참가자 스크롤바**: 참석 인원이 많아도 UI가 깨지지 않도록 CSS 커스텀 스크롤바가 적용되어 있습니다.
- **월별 필터링**: 당월 행사만 리스트에 노출하여 관리 오작동을 방지합니다.

### 4. 📊 활동 결과 보고서 생성
- **자동 텍스트 생성**: 행사 내역, 참석 명단, 앨범 링크, 시상 대상자, 미참석 경고 명단을 한 번에 추출합니다.
- **밴드 게시 최적화**: 마크다운이 제거된 깔끔한 텍스트 형식을 제공하여 네이버 밴드에 즉시 복사-붙여넣기가 가능합니다.

---

## 🛠️ 기술 스택 (Tech Stack)
- **Framework**: Streamlit
- **Database**: DuckDB (In-process SQL)
- **Library**: Pandas, Tabulate

## 📝 설치 및 실행 (Setup)
```bash
pip install streamlit pandas duckdb
streamlit run app.py